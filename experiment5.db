create table customer(
cust_no int primary key,
cust_name varchar(50)
);
create table membership (
mem_no int,
cust_no int,
primary key(mem_no, cust_no),
foreign key(cust_no) references customer
);
create table cassette(
cass_no int,
cass_name varchar(50),
Language varchar(50),
primary key(cass_no)
);
create table iss_rec(
iss_no int,
iss_date DATE,
mem_no int,
cass_no int,
primary key(iss_no,mem_no,cass_no)
);

Insert into customer values(101, 'bhavini');
Insert into customer values(102, 'karunya');
Insert into customer values(103, 'yashika');
Insert into customer values(104, 'aditya');
Insert into customer values(105, 'nehal');
Insert into customer values(106, 'ishita');
Insert into customer values(107, 'titiksha');
Insert into customer values(108, 'anshee');
Insert into customer values(109, 'anubhuti');
Insert into customer values(110, 'manav');
Select * from customer;

Insert into membership values(1, 101);
Insert into membership values(2, 102);
Insert into membership values(3, 103);
Insert into membership values(4, 104);
Insert into membership values(5, 105);
Insert into membership values(6, 106);
Insert into membership values(7, 107);
Insert into membership values(8, 108);
Insert into membership values(9, 109);
Insert into membership values(10, 110);
Select * from membership;

insert into cassette values(1001,'anuv jain', 'hindi');
insert into cassette values(1002, 'zaeden', 'hindi');
insert into cassette values(1003, 'justin beiber', 'english');
insert into cassette values(1004, 'bts', 'korean');
insert into cassette values(1005, 'local train', 'hindi');
insert into cassette values(1006, 'ritwiz', 'hindi');
insert into cassette values(1007, 'taylor swift', 'english');
insert into cassette values(1008, 'prateek kuhad', 'hindi');
insert into cassette values(1009, 'ariana', 'english');
insert into cassette values(1010, 'travis', 'english');
Select * from cassette;

insert into iss_rec values(11,'04-May-2020',1,1001);
insert into iss_rec values(12,'09-Jun-2019',2,1002);
insert into iss_rec values(13,'16-Dec-2009',3,1003);
insert into iss_rec values(14,'24-Apr-2016',4,1004);
insert into iss_rec values(15,'18-Oct-2017',5,1005);
insert into iss_rec values(16,'03-Nov-2015',6,1006);
insert into iss_rec values(17,'12-Feb-2008',7,1007);
insert into iss_rec values(18,'27-Jan-2010',8,1008);
insert into iss_rec values(19,'08-Mar-2009',9,1009);
insert into iss_rec values(20,'30-Sep-2018',10,1010);
Select * from iss_rec;

select c.cust_name,m.mem_no from customer c , membership m , cassette cs,iss_rec
i where c.cust_no=m.cust_no and m.mem_no=i.mem_no and cs.cass_no=i.cass_no;

select i.iss_no , c.cust_name,cs.cass_name from customer c, membership m ,
cassette cs , iss_rec i where c.cust_no=m.cust_no and m.mem_no=i.mem_no and 
cs.cass_no=i.cass_no and i.iss_date='04-May-20';

select c.cust_no , c.cust_name ,cs.cass_no,i.iss_no,i.iss_date,m.mem_no 
from customer c,membership m,cassette cs,iss_rec i where c.cust_no=m.cust_no
and m.mem_no=i.mem_no and cs.cass_no=i.cass_no and cs.cass_name='ritwiz';

select count(*),c.cust_name from iss_rec i , membership m, customer c ,
cassette cs where c.cust_no=m.cust_no and m.mem_no=i.mem_no and
cs.cass_no=i.cass_no group by cs.cass_name;

select * from customer c, membership m , cassette cs,iss_rec i where c.cust_no=m.cust_no 
and m.mem_no=i.mem_no and cs.cass_no=i.cass_no and m.mem_no=5;

select * from iss_rec i,customer c,cassette cs,membership m  where 
c.cust_no=m.cust_no and m.mem_no=i.mem_no and cs.cass_no=i.cass_no and 
i.iss_date='30-SEP-18';

create view detail as select i.iss_no,i.iss_date,c.cust_name,cs.cass_name from 
customer c , membership m ,cassette cs,iss_rec i where  
c.cust_no=m.cust_no and m.mem_no=i.mem_no and cs.cass_no=i.cass_no ;
select *from detail;

select * from iss_rec i,customer c,cassette cs,membership m  where 
c.cust_no=m.cust_no and m.mem_no=i.mem_no and cs.cass_no=i.cass_no and 
i.iss_date between '30-SEP-18' and '12-DEC-20';